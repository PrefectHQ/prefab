---
title: ForEach
description: Repeat components for each item in a data list.
icon: repeat
---

import { ComponentPreview } from '/snippets/component-preview.mdx'

Given a list of data, `ForEach` renders its children once per item — a card for each user, a badge for each tag, a row for each result. Python's context manager gives you a handle to the current item, so you can access fields naturally with dot notation.

## Basic Usage

<ComponentPreview json={{"view":{"cssClass":"gap-2","type":"Column","children":[{"type":"ForEach","key":"crew","children":[{"type":"Card","children":[{"type":"CardHeader","children":[{"cssClass":"gap-2 items-center","type":"Row","children":[{"type":"CardTitle","content":"{{ $item.name }}"},{"type":"Badge","label":"{{ $item.designation }}","variant":"secondary"}]},{"type":"CardDescription","content":"{{ $item.email }}"}]}]}]}]},"state":{"crew":[{"name":"Arthur Dent","designation":"Sandwich Maker","email":"arthur@heart-of-gold.ship"},{"name":"Ford Prefect","designation":"Researcher","email":"ford@megadodo.pub"},{"name":"Trillian","designation":"Astrophysicist","email":"trillian@heart-of-gold.ship"}]}}} playground="ZnJvbSBwcmVmYWJfdWkuYXBwIGltcG9ydCBzZXRfaW5pdGlhbF9zdGF0ZQpmcm9tIHByZWZhYl91aS5jb21wb25lbnRzIGltcG9ydCAoCiAgICBDYXJkLAogICAgQ2FyZEhlYWRlciwKICAgIENhcmRUaXRsZSwKICAgIENhcmREZXNjcmlwdGlvbiwKICAgIEJhZGdlLAogICAgQ29sdW1uLAogICAgUm93LAopCmZyb20gcHJlZmFiX3VpLmNvbXBvbmVudHMuY29udHJvbF9mbG93IGltcG9ydCBGb3JFYWNoCgpzZXRfaW5pdGlhbF9zdGF0ZShjcmV3PVsKICAgIHsibmFtZSI6ICJBcnRodXIgRGVudCIsICJkZXNpZ25hdGlvbiI6ICJTYW5kd2ljaCBNYWtlciIsICJlbWFpbCI6ICJhcnRodXJAaGVhcnQtb2YtZ29sZC5zaGlwIn0sCiAgICB7Im5hbWUiOiAiRm9yZCBQcmVmZWN0IiwgImRlc2lnbmF0aW9uIjogIlJlc2VhcmNoZXIiLCAiZW1haWwiOiAiZm9yZEBtZWdhZG9kby5wdWIifSwKICAgIHsibmFtZSI6ICJUcmlsbGlhbiIsICJkZXNpZ25hdGlvbiI6ICJBc3Ryb3BoeXNpY2lzdCIsICJlbWFpbCI6ICJ0cmlsbGlhbkBoZWFydC1vZi1nb2xkLnNoaXAifSwKXSkKCndpdGggQ29sdW1uKGdhcD0yKToKICAgIHdpdGggRm9yRWFjaCgiY3JldyIpIGFzIG1lbWJlcjoKICAgICAgICB3aXRoIENhcmQoKToKICAgICAgICAgICAgd2l0aCBDYXJkSGVhZGVyKCk6CiAgICAgICAgICAgICAgICB3aXRoIFJvdyhnYXA9MiwgYWxpZ249ImNlbnRlciIpOgogICAgICAgICAgICAgICAgICAgIENhcmRUaXRsZShtZW1iZXIubmFtZSkKICAgICAgICAgICAgICAgICAgICBCYWRnZShtZW1iZXIuZGVzaWduYXRpb24sIHZhcmlhbnQ9InNlY29uZGFyeSIpCiAgICAgICAgICAgICAgICBDYXJkRGVzY3JpcHRpb24obWVtYmVyLmVtYWlsKQo=">
<CodeGroup>
```python Python icon="python"
from prefab_ui.app import set_initial_state
from prefab_ui.components import (
    Card,
    CardHeader,
    CardTitle,
    CardDescription,
    Badge,
    Column,
    Row,
)
from prefab_ui.components.control_flow import ForEach

set_initial_state(crew=[
    {"name": "Arthur Dent", "designation": "Sandwich Maker", "email": "arthur@heart-of-gold.ship"},
    {"name": "Ford Prefect", "designation": "Researcher", "email": "ford@megadodo.pub"},
    {"name": "Trillian", "designation": "Astrophysicist", "email": "trillian@heart-of-gold.ship"},
])

with Column(gap=2):
    with ForEach("crew") as member:
        with Card():
            with CardHeader():
                with Row(gap=2, align="center"):
                    CardTitle(member.name)
                    Badge(member.designation, variant="secondary")
                CardDescription(member.email)
```
```json Protocol icon="brackets-curly"
{
  "view": {
    "cssClass": "gap-2",
    "type": "Column",
    "children": [
      {
        "type": "ForEach",
        "key": "crew",
        "children": [
          {
            "type": "Card",
            "children": [
              {
                "type": "CardHeader",
                "children": [
                  {
                    "cssClass": "gap-2 items-center",
                    "type": "Row",
                    "children": [
                      {"type": "CardTitle", "content": "{{ $item.name }}"},
                      {"type": "Badge", "label": "{{ $item.designation }}", "variant": "secondary"}
                    ]
                  },
                  {"type": "CardDescription", "content": "{{ $item.email }}"}
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "state": {
    "crew": [
      {
        "name": "Arthur Dent",
        "designation": "Sandwich Maker",
        "email": "arthur@heart-of-gold.ship"
      },
      {
        "name": "Ford Prefect",
        "designation": "Researcher",
        "email": "ford@megadodo.pub"
      },
      {
        "name": "Trillian",
        "designation": "Astrophysicist",
        "email": "trillian@heart-of-gold.ship"
      }
    ]
  }
}
```
</CodeGroup>
</ComponentPreview>

When rendered with the data above, this produces one card per crew member.

## Scalar Items

The `key` you pass to `ForEach` names a list field in your data. When items are simple values (strings, numbers), the context manager variable represents the value directly.

<ComponentPreview json={{"view":{"cssClass":"gap-2","type":"Row","children":[{"type":"ForEach","key":"tags","children":[{"type":"Badge","label":"{{ $item }}","variant":"secondary"}]}]},"state":{"tags":["earth","magrathea","vogon poetry","42"]}}} playground="ZnJvbSBwcmVmYWJfdWkuYXBwIGltcG9ydCBzZXRfaW5pdGlhbF9zdGF0ZQpmcm9tIHByZWZhYl91aS5jb21wb25lbnRzIGltcG9ydCBCYWRnZSwgUm93CmZyb20gcHJlZmFiX3VpLmNvbXBvbmVudHMuY29udHJvbF9mbG93IGltcG9ydCBGb3JFYWNoCgpzZXRfaW5pdGlhbF9zdGF0ZSh0YWdzPVsiZWFydGgiLCAibWFncmF0aGVhIiwgInZvZ29uIHBvZXRyeSIsICI0MiJdKQoKd2l0aCBSb3coZ2FwPTIpOgogICAgd2l0aCBGb3JFYWNoKCJ0YWdzIikgYXMgdGFnOgogICAgICAgIEJhZGdlKHRhZywgdmFyaWFudD0ic2Vjb25kYXJ5IikK">
<CodeGroup>
```python Python icon="python"
from prefab_ui.app import set_initial_state
from prefab_ui.components import Badge, Row
from prefab_ui.components.control_flow import ForEach

set_initial_state(tags=["earth", "magrathea", "vogon poetry", "42"])

with Row(gap=2):
    with ForEach("tags") as tag:
        Badge(tag, variant="secondary")
```
```json Protocol icon="brackets-curly"
{
  "view": {
    "cssClass": "gap-2",
    "type": "Row",
    "children": [
      {
        "type": "ForEach",
        "key": "tags",
        "children": [{"type": "Badge", "label": "{{ $item }}", "variant": "secondary"}]
      }
    ]
  },
  "state": {"tags": ["earth", "magrathea", "vogon poetry", "42"]}
}
```
</CodeGroup>
</ComponentPreview>

With `{"tags": ["earth", "magrathea", "vogon poetry", "42"]}`, this renders one badge per tag.

## Using the Index

Each iteration also has access to `$index` — the zero-based position of the current item. Import the `INDEX` constant from `prefab_ui.rx` to use it in expressions.

<ComponentPreview json={{"view":{"cssClass":"gap-1","type":"Column","children":[{"type":"ForEach","key":"steps","children":[{"content":"{{ $index + 1 }}. {{ $item }}","type":"Text"}]}]},"state":{"steps":["Collect underpants","?","Profit"]}}} playground="ZnJvbSBwcmVmYWJfdWkuYXBwIGltcG9ydCBzZXRfaW5pdGlhbF9zdGF0ZQpmcm9tIHByZWZhYl91aS5jb21wb25lbnRzIGltcG9ydCBDb2x1bW4sIFRleHQKZnJvbSBwcmVmYWJfdWkuY29tcG9uZW50cy5jb250cm9sX2Zsb3cgaW1wb3J0IEZvckVhY2gKZnJvbSBwcmVmYWJfdWkucnggaW1wb3J0IElOREVYCgpzZXRfaW5pdGlhbF9zdGF0ZShzdGVwcz1bIkNvbGxlY3QgdW5kZXJwYW50cyIsICI/IiwgIlByb2ZpdCJdKQoKd2l0aCBDb2x1bW4oZ2FwPTEpOgogICAgd2l0aCBGb3JFYWNoKCJzdGVwcyIpIGFzIHN0ZXA6CiAgICAgICAgVGV4dChmIntJTkRFWCArIDF9LiB7c3RlcH0iKQo=">
<CodeGroup>
```python Python icon="python"
from prefab_ui.app import set_initial_state
from prefab_ui.components import Column, Text
from prefab_ui.components.control_flow import ForEach
from prefab_ui.rx import INDEX

set_initial_state(steps=["Collect underpants", "?", "Profit"])

with Column(gap=1):
    with ForEach("steps") as step:
        Text(f"{INDEX + 1}. {step}")
```
```json Protocol icon="brackets-curly"
{
  "view": {
    "cssClass": "gap-1",
    "type": "Column",
    "children": [
      {
        "type": "ForEach",
        "key": "steps",
        "children": [{"content": "{{ $index + 1 }}. {{ $item }}", "type": "Text"}]
      }
    ]
  },
  "state": {"steps": ["Collect underpants", "?", "Profit"]}
}
```
</CodeGroup>
</ComponentPreview>

`INDEX` is especially useful for actions that target a specific list position — `SetState(f"items.{INDEX}.done", True)` updates the `done` field of the current item.

## Nested Data

Dot notation chains through nested objects naturally — `project.owner.name` reaches into `{"owner": {"name": "..."}}` just as you'd expect.

<ComponentPreview json={{"view":{"cssClass":"gap-2","type":"Column","children":[{"type":"ForEach","key":"projects","children":[{"type":"Card","children":[{"type":"CardHeader","children":[{"type":"CardTitle","content":"{{ $item.name }}"},{"type":"CardDescription","content":"Owner: {{ $item.owner.name }}"}]}]}]}]},"state":{"projects":[{"name":"Heart of Gold","owner":{"name":"Zaphod Beeblebrox"}},{"name":"Hitchhiker's Guide","owner":{"name":"Ford Prefect"}}]}}} playground="ZnJvbSBwcmVmYWJfdWkuYXBwIGltcG9ydCBzZXRfaW5pdGlhbF9zdGF0ZQpmcm9tIHByZWZhYl91aS5jb21wb25lbnRzIGltcG9ydCAoCiAgICBDYXJkLAogICAgQ2FyZEhlYWRlciwKICAgIENhcmRUaXRsZSwKICAgIENhcmREZXNjcmlwdGlvbiwKICAgIENvbHVtbiwKKQpmcm9tIHByZWZhYl91aS5jb21wb25lbnRzLmNvbnRyb2xfZmxvdyBpbXBvcnQgRm9yRWFjaAoKc2V0X2luaXRpYWxfc3RhdGUocHJvamVjdHM9WwogICAgeyJuYW1lIjogIkhlYXJ0IG9mIEdvbGQiLCAib3duZXIiOiB7Im5hbWUiOiAiWmFwaG9kIEJlZWJsZWJyb3gifX0sCiAgICB7Im5hbWUiOiAiSGl0Y2hoaWtlcidzIEd1aWRlIiwgIm93bmVyIjogeyJuYW1lIjogIkZvcmQgUHJlZmVjdCJ9fSwKXSkKCndpdGggQ29sdW1uKGdhcD0yKToKICAgIHdpdGggRm9yRWFjaCgicHJvamVjdHMiKSBhcyBwcm9qZWN0OgogICAgICAgIHdpdGggQ2FyZCgpOgogICAgICAgICAgICB3aXRoIENhcmRIZWFkZXIoKToKICAgICAgICAgICAgICAgIENhcmRUaXRsZShwcm9qZWN0Lm5hbWUpCiAgICAgICAgICAgICAgICBDYXJkRGVzY3JpcHRpb24oZiJPd25lcjoge3Byb2plY3Qub3duZXIubmFtZX0iKQo=">
<CodeGroup>
```python Python icon="python"
from prefab_ui.app import set_initial_state
from prefab_ui.components import (
    Card,
    CardHeader,
    CardTitle,
    CardDescription,
    Column,
)
from prefab_ui.components.control_flow import ForEach

set_initial_state(projects=[
    {"name": "Heart of Gold", "owner": {"name": "Zaphod Beeblebrox"}},
    {"name": "Hitchhiker's Guide", "owner": {"name": "Ford Prefect"}},
])

with Column(gap=2):
    with ForEach("projects") as project:
        with Card():
            with CardHeader():
                CardTitle(project.name)
                CardDescription(f"Owner: {project.owner.name}")
```
```json Protocol icon="brackets-curly"
{
  "view": {
    "cssClass": "gap-2",
    "type": "Column",
    "children": [
      {
        "type": "ForEach",
        "key": "projects",
        "children": [
          {
            "type": "Card",
            "children": [
              {
                "type": "CardHeader",
                "children": [
                  {"type": "CardTitle", "content": "{{ $item.name }}"},
                  {"type": "CardDescription", "content": "Owner: {{ $item.owner.name }}"}
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "state": {
    "projects": [
      {"name": "Heart of Gold", "owner": {"name": "Zaphod Beeblebrox"}},
      {"name": "Hitchhiker's Guide", "owner": {"name": "Ford Prefect"}}
    ]
  }
}
```
</CodeGroup>
</ComponentPreview>

## API Reference

<Card icon="code" title="ForEach Parameters">
<ParamField body="key" type="str" required>
  The data field containing the list to iterate over. Can be passed as a positional argument.
</ParamField>

<ParamField body="css_class" type="str | None" default="None">
  Additional Tailwind CSS classes for the wrapper element.
</ParamField>
</Card>

## Protocol Reference

```json ForEach
{
  "type": "ForEach",
  "children?": "[Component]",
  "let?": "object",
  "key": "string (required)",
  "cssClass?": "string"
}
```

For the complete protocol schema, see [ForEach](/protocol/for-each).
