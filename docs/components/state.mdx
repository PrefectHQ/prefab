---
title: State
description: Provide scoped interpolation values to children.
icon: database
---

import { ComponentPreview } from '/snippets/component-preview.mdx'

`State` provides local [interpolation](/patterns/interpolation) values to its children. Children resolve `{{ }}` template expressions against the State's values first, falling through to parent scopes and then global state.

This is useful when you want to inject data into a subtree without polluting global state or duplicating values across multiple props.

## Basic Usage

<ComponentPreview auto json={`{"type":"State","state":{"name":"Arthur Dent","role":"Reluctant Adventurer"},"children":[{"type":"Card","children":[{"type":"CardHeader","children":[{"type":"CardTitle","content":"{{ name }}"},{"type":"CardDescription","content":"{{ role }}"}]}]}]}`}>
<CodeGroup>
```python Python icon="python"
from prefab_ui.components import (
    Card,
    CardDescription,
    CardHeader,
    CardTitle,
    State,
)

with State(name="Arthur Dent", role="Reluctant Adventurer"):
    with Card():
        with CardHeader():
            CardTitle("{{ name }}")
            CardDescription("{{ role }}")
```
```json Protocol icon="brackets-curly"
{
  "type": "State",
  "state": {
    "name": "Arthur Dent",
    "role": "Reluctant Adventurer"
  },
  "children": [
    {
      "type": "Card",
      "children": [
        {
          "type": "CardHeader",
          "children": [
            {
              "type": "CardTitle",
              "content": "{{ name }}"
            },
            {
              "type": "CardDescription",
              "content": "{{ role }}"
            }
          ]
        }
      ]
    }
  ]
}
```
</CodeGroup>
</ComponentPreview>

## How It Works

Any kwargs that aren't base component fields (`css_class`, `visible_when`, etc.) are collected into the state dict. You can also pass a dict positionally:

```python Equivalent Forms
from prefab_ui.components import State, Text

# Kwargs style
with State(name="Ford", role="Researcher"):
    Text("{{ name }} is a {{ role }}")

# Dict style
with State({"name": "Ford", "role": "Researcher"}):
    Text("{{ name }} is a {{ role }}")
```

Both forms produce the same wire format — a `State` node with a `state` object.

## Nested State

State components can nest. Inner values shadow outer ones for the same key, and children see the merged context:

<ComponentPreview auto json={`{"cssClass":"gap-2","type":"Column","children":[{"type":"State","state":{"greeting":"Don't Panic","name":"Arthur"},"children":[{"type":"Text","content":"{{ greeting }}, {{ name }}"},{"type":"State","state":{"name":"Ford"},"children":[{"type":"Text","content":"{{ greeting }}, {{ name }}"}]}]}]}`}>
<CodeGroup>
```python Python icon="python"
from prefab_ui.components import Column, State, Text

with Column(gap=2):
    with State(greeting="Don't Panic", name="Arthur"):
        Text("{{ greeting }}, {{ name }}")
        with State(name="Ford"):
            Text("{{ greeting }}, {{ name }}")
```
```json Protocol icon="brackets-curly"
{
  "cssClass": "gap-2",
  "type": "Column",
  "children": [
    {
      "type": "State",
      "state": {
        "greeting": "Don't Panic",
        "name": "Arthur"
      },
      "children": [
        {
          "type": "Text",
          "content": "{{ greeting }}, {{ name }}"
        },
        {
          "type": "State",
          "state": {
            "name": "Ford"
          },
          "children": [
            {
              "type": "Text",
              "content": "{{ greeting }}, {{ name }}"
            }
          ]
        }
      ]
    }
  ]
}
```
</CodeGroup>
</ComponentPreview>

The first `Text` renders "Don't Panic, Arthur". The second renders "Don't Panic, Ford" — the inner `State` shadows `name` but inherits `greeting`.

## With ForEach

State works well alongside [ForEach](/components/foreach) for providing extra context to iterated templates:

<ComponentPreview auto json={`{"_tree":{"type":"State","state":{"prefix":"Speaks"},"children":[{"cssClass":"gap-2 items-center","type":"Row","children":[{"type":"ForEach","key":"languages","children":[{"type":"Badge","label":"{{ prefix }}: {{ _item }}","variant":"secondary"}]}]}]},"languages":["Python","TypeScript","Rust"]}`}>
<CodeGroup>
```python Python icon="python"
from prefab_ui.components import Badge, ForEach, Row, State

set_data(languages=["Python", "TypeScript", "Rust"])

with State(prefix="Speaks"):
    with Row(gap=2, align="center"):
        with ForEach("languages"):
            Badge(
                "{{ prefix }}: {{ _item }}",
                variant="secondary",
            )
```
```json Protocol icon="brackets-curly"
{
  "_tree": {
    "type": "State",
    "state": {
      "prefix": "Speaks"
    },
    "children": [
      {
        "cssClass": "gap-2 items-center",
        "type": "Row",
        "children": [
          {
            "type": "ForEach",
            "key": "languages",
            "children": [
              {
                "type": "Badge",
                "label": "{{ prefix }}: {{ _item }}",
                "variant": "secondary"
              }
            ]
          }
        ]
      }
    ]
  },
  "languages": [
    "Python",
    "TypeScript",
    "Rust"
  ]
}
```
</CodeGroup>
</ComponentPreview>

## API Reference

<Card icon="code" title="State Parameters">
<ParamField body="state" type="dict[str, Any]" default="{}">
  Dictionary of local state values. Can be passed as a positional dict or via kwargs.
</ParamField>

<ParamField body="css_class" type="str | None" default="None">
  Additional Tailwind CSS classes for the wrapper element.
</ParamField>

<ParamField body="visible_when" type="str | None" default="None">
  Conditional visibility expression.
</ParamField>
</Card>

## Protocol Reference

For the complete protocol schema, see the [State protocol definition](/protocol/state).

```json State
{
  "type": "State",
  "state": "object (required)",
  "cssClass?": "string",
  "visibleWhen?": "string",
  "children": []
}
```
